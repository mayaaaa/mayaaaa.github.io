---
layout: post
title: Implicit Neural Representations with Periodic Activation Functions 
tags: [NeurIPS20]
---

### [PDF](https://papers.nips.cc/paper/2020/hash/53c04118df112c13a8c34b38343b9c10-Abstract.html)
### [Video](https://www.youtube.com/watch?v=Or9J-DCDGko)

**アブスト**
- 画像, ビデオ, 点群, 音声等のシグナルのmapping $$\Phi$$をニューラルネットで記述する手法が提案されている
  - 例えば画像ピクセルの座標を入力したときに各ピクセルのRGB値を返す関数 $$\Phi$$をニューラルネットでモデル化
  - このような $$\Phi$$のパラメータを本稿では画像のimplicit representationと呼ぶ
  - この場合, 各ピクセル $${\bf X}_i$$のRGB $$f({\bf X}_i)$$と$$\Phi({\bf X}_i)$$の二乗誤差が最小になるような$$\Phi$$のパラメータを学習する
  - このような手法は画像を直接読み込むCNN等の手法と違ってグリッドの解像度に依存しない, メモリがシグナルの複雑さにスケールする, priorを考慮できる等のメリットがある
  - しかしRelu, tanh等の一般的なactivation functionを用いたMLPでは表現力に限界がある (位置普遍性の原則を満たさないのが一因)
  - また, Reluを使ったimplicit representationは1階微分がpiecewise constantに, 2階微分が0になる
    - 2階微分に意味がある場合これを利用することができない
    - 2階微分の非線形性を捉えることができない
- 提案手法はニューラルネット $$\Phi$$のactivation functionとしてsin関数を使い
- sin関数の特徴はその微分がcos関数 (すなわち位相をずらしたsin関数)で表せること
- この特徴を利用することでニューラルネットの出力そのものだけでなく入力 (画像の場合ピクセル座標)の1階微分, 2階微分についての学習もできるようになる 

**提案手法**
- 以下の制約を満たしながら $$\Phi$$のパラメータを最適化するタスクを考える
  - $$\mathcal{C}=\{{\bf x}, \Phi, \Delta_{\bf x}\Phi, \Delta^2_{\bf x}\Phi, ...\}=0$$
  - ここで$${\bf x}$$は座標, $$\Phi$$はニューラルネット
  - 本稿ではこのような表現 $$\Phi$$をimplicit neural representationと呼ぶ
  - このようなタスクは科学の幅広い分野で重要である
    - 符号付き距離関数を用いた三次元点群のモデル化, より一般的にはヘルムホルツ方程式, ポアソン方程式, 波動方程式などの境界値問題
- MLPのactivation functionを単純にsin関数で置き換え, それに合わせた初期化手法を提案する
- 具体的にはニューラルネット $$\Phi$$の $i$層目の変換を次式でモデル化
  - $$\phi_i({\bf x}_i)=\text{sin}({\bf W}_i{\bf x}_i+{\bf b}_i)$$
  - ここで $${\bf W}_i$$は重み行列, $${\bf b}_i$$はバイアスパラメータ
- このような定式化により, 提案手法の微分はそれ自身が提案手法の複合関数になる
  - sin関数の特徴はその微分がcos関数 (すなわち位相をずらしたsin関数)になるため
- 従ってニューラルネットの出力そのものだけでなくその微分についての学習も可能になる
- 図1は微分を使わないシンプルな画像系列へのfittingについて学習した例
  - ピクセルの座標 {\bf x}_iに対してRGB $$f({\bf x}_i)$$を回帰 
  - 一番上の列を見ると提案手法はRelu等を使った既存手法よりうまく詳細を再構築できている
  - さらに (学習の際は利用していないが)画像の微分を取れるというメリットもある
  - 図1の下2列にニューラルネットの1階微分, 2階微分を取った結果を示す
  - 前述の通り, Reluを使ったニューラルネットについては2階微分が0になっている
  - 提案手法は (学習の際は使っていないにも関わらず)画像のRGBそのものだけでなく1階微分, 2階微分についてもうまく再現できている
- さらにsin関数を用いたMLPのパラメータ初期化のための手法を提案

**実験**
- 微分を直接最適化することでポアソン方程式を解いた結果 ($$\S$$4.1), Eikonal方程式を微分について制約を課すことで解いた結果 ($$\S$$4.2)を示す
- ヘルムホルツの偏微分方程式,  



