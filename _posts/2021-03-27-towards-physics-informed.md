---
layout: post
title: "Towards physics-informed deep learning for turbulent flow prediction"
tags: [KDD20]
---

<!--more-->

[PDF](https://arxiv.org/pdf/1911.08655.pdf)

**イントロ**
- 広範囲に広がる時空間データのモデル化は理工学分野 (水文地質学, 固体力学, 反応速度論など)における基本的な課題
  - 例えば, 数値流体力学 (CFD)は気候モデルの中核をなし, 気候の変化の理解・予測に用いられる
  - 大気CFDは物理法則のみに基づいたもの
    - 物理法則を偏微分方程式 (PDE)で記述し, 数値積分で解く
    - 膨大な計算量が必要になる
- 深層学習に物理法則を取り入れたアプローチが提案されている
  - 海面の温度を予測する線形移流拡散方程式ベースの手法
  - 損失関数を物理的制約で明示的に正則化することで湖の温度をモデル化する物理法則ベースのニューラルネットワーク
    - 正則化は非常にアドホックなもので, 正則化のハイパーパラメータの調整が難しい
  - 損失関数に統計的制約と物理的制約を導入し, 予測を正則化することで物理シミュレーションを模倣
    - 時間的な変動を伴わない空間的なモデリングにのみ焦点を当てている
- 本論文では, 時空間的な乱流の変化を予測する問題に取り組む
  - 乱流は高次元非線形ナビエ・ストークス方程式で記述される
  - 海面温度や湖の変動のモデル化とは違い, 乱流はカオス性を持ち, 初期条件に大きく依存
  - また, 乱流はマルチスケールの挙動を示し, 異なる長さ・時間のスケールで制御されている
  - さらに, 高解像度の乱流は高次元の予測問題に帰結する
    - 例えば，離散化された128$$\times$$128$$\times$$100の速度場は $$10^6$$次元
    - 大量の学習データが必要となる&誤差が伝播する
- 乱流モデルと深層学習を統合した手法を提案
- 提案手法は, スケール分離を適用し, 異なるスケールを個別にモデル化
  - レイノルズ平均モデル (RANS)とラージエディシミュレーション (LES)を組み合わせた乱流モデルRANS-LESをベースとする
    - RANS: 速度場 $${\bf w}(t)$$を平均的な流量 $$\bar{\bf w}$$と時間的な変動を表す項 $${\bf w}'$$に分解
      - $$\bar{\bf w}$$を温度 $${\bf w}(t)$$の時間畳み込みでモデル化
    - LES: 速度場 $${\bf w}(t)$$を平均的な流量 $$\tilde{\bf w}$$と空間的な変動を表す項 $${\bf w}'$$に分解
      - $$\tilde{\bf w}$$を温度 $${\bf w}(t)$$の空間畳み込みでモデル化
    - RANS-LESモデルでは速度場を $${\bf w} = \bar{\bf w} + \tilde{\bf w} + {\bf w}'$$の3つの要素に分解
  - 固定の畳み込みフィルタではなく, 学習可能な畳み込み層を使用
- 乱流を3つの要素に分解し, それぞれをU-netで近似
- 60ステップ先までの速度場の予測を行い, 既存手法と比較
  - 提案手法は正確で物理的に意味のある

**提案手法**
- 速度場データは各時刻における速度場のスナップショット (画像)の系列で表される
- 時刻 $$t$$の速度場を入力として次の時刻 $$t$$のスナップショットを出力するモデルを学習
- RANS-LESモデルの空間畳み込みフィルタ $$S(\xi)$$, 時間畳み込みフィルタ $$T(s)$$をニューラルネットの畳み込みで置き換え
  - 入力の速度場のスナップショット $${\bf w}$$に1層の5$$\times$$5空間畳み込みをかけ, $${\bf w}'$$とする
  - 入力の速度場のスナップショット $${\bf w}$$に1層の1$$\times$$1時間畳み込みをかけ, $$\tilde{\bf w}$$, $$\bar{\bf w}$$とする
- 3つの要素 $${\bf w}'$$, $$\tilde{\bf w}$$, $$\bar{\bf w}$$を別々にエンコード
- 3つの要素の相互作用をモデル化するため, エンコーダの出力 $$E({\bf w}')$$, $$E(\tilde{\bf w})$$, $$E(\bar{\bf w})$$に単一のデコーダーをかませる
- デコーダ, エンコーダをU-netでモデル化
- 長期の予測を行うため, 1ステップの予測を逐次的に繰り返す
- 提案手法のバリエーションとして, 乱流の発散 $$\nabla\cdot{\bf w}$$が0となるような正則化 $${\vert\vert\nabla\cdot{\bf w}\vert\vert}^2$$を加えたモデルも提案

**実験**
- 格子ボルツマン法でシミュレーションした速度場データを用いて実験
- 速度場の予測精度をRMSEで評価
  - 提案手法は1〜60の全タイムステップにおいて既存手法を上回る精度 
  - 正則化を加えた提案手法がより良い精度
- 計算時間においても提案手法を上回る速度
  - 特に数値積分を用いた手法を大幅に上回る

